pipeline{

    agent any
    tools{
        maven 'maven 3.6.3'
    }



stages{
    //specifyvarious stages with in stage

    //stage1 .Build
    stage('Build maven project'){
        steps{
            sh 'mvn clean install package'
        }
    }

   // stage2 :Testing
    stage('code analasis'){
        steps {
               withSonarQubeEnv('sonarqube9.9.0'){
          sh ' mvn clean verify sonar:sonar \
  -Dsonar.projectKey=sonar-project \
  -Dsonar.login=sqp_78060b2f1318c027d6bf87a5a3868163436b86b8'
        }
      }
    }
     stage('upload war to nexus'){
         steps{
            nexusArtifactUploader artfacts:[
               [artifactId: '  spring-petclinic',
                classifier: '',
                file: 'target/  spring-petclinic-3.0.4.war',
                 type: 'war'
                ]
            ],
        credentialsId: 'nexus3',
         groupId: 'org.springframework.boot',
         nexusUrl: '13.234.20.45:8081',
         nexusVersion: 'nexus3',
          protocol: 'http',
          repository: 'http://13.234.20.45:8081/repository/petclinic-app/',
          version: '3.0.4',


                  }
            }
           
      
      }
}


